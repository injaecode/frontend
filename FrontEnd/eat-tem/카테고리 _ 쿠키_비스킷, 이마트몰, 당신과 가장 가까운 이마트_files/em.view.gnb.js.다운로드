"use strict";var em=em||{};em.View=em.View||{};em.Model=em.Model||{};em.Event=em.Event||{};em.Event.emitter={subscribers:{},on:function t(e,n,i){this.subscribers[e]=this.subscribers[e]||[],this.subscribers[e].push({callback:n,context:i})},off:function t(e,n,i){var s,a,o=this.subscribers[e];if(o)for(s=o.length-1;s>=0;){if(a=o[s],a.callback===n&&(!i||a.context===i)){o.splice(s,1);break}s--}},emit:function t(e){var n,i=this.subscribers[e],s=0,a=Array.prototype.slice.call(arguments,1);if(i)for(;s<i.length;){n=i[s],n.callback.apply(n.context||this,a),s++}}};em.Model.mallCategory=function(t){$.extend(this,t||{})};em.Model.mallCategory.prototype={sUrl:null,sMallCode:null,htData:{L:[]},getCategoryInfo:function t(){var e=this;if(this.sUrl===null){return}return $.ajax({type:"get",url:this.sUrl,async:false,dataType:"script",cache:true}).then(function(){e.htData=ctgAll;return ctgAll||[]})},getCtgDataByCode:function t(e,n){var i,s;for(i in e){if(i=="C"){if(e[i]==n){return e}}else if(e[i]instanceof Object){if(e.hasOwnProperty(i)){s=this.getCtgDataByCode(e[i],n);if(s){return s}}}}return false}};em.View.totalCategory=function(t){$.extend(this,t||{});this.init()};em.View.totalCategory.prototype=$.extend({_nDefaultWidth:0,_nMaxLevel:3,_bMouseOver:false,_oCurrent:{elem:null,level:0},init:function t(){this._assignElements();this._attachEventHandlers()},_assignElements:function t(){this._window=$(window);this._welCtgArea=$(".emgnb_ctg");this._welCtgTotal=this._welCtgArea.find(".emgnb_ctg_total");this._welCtgCont=this._welCtgTotal.find(".emgnb_ctg_cont");this._welCtgList=this._welCtgTotal.find(".emgnb_ctg_list");this._welCtgOpen=this._welCtgArea.find(".emgnb_ctg_open");this._welAsideBar=$("#_cmskyCard, #sky_scraper")},_attachEventHandlers:function t(){this._welCtgOpen.on("click",$.proxy(this._onClickToggleCategory,this));this._welCtgArea.on("mouseenter",$.proxy(this._onMouseenterCategoryOpen,this));this._welCtgArea.on("mouseleave",$.proxy(this._onMouseleaveCategoryOpen,this));this._welCtgList.menuAim({rowSelector:".emgnb_ctg_topmn",activate:$.proxy(this._activeSubMenu,this),enter:$.proxy(this._enterSubMenu,this),exitMenu:$.proxy(this._exitSubMenu,this)}).find(".emgnb_ctg_topmn").off("click")},_activeSubMenu:function t(e){var n=$(e);this._showSubMenu(n)},_deactivateSubMenu:function t(e){var n=$(e);this._hideSubMenu(n)},_enterSubMenu:function t(){this._bMouseOver=true;this._welCtgList.find(".emgnb_ctg_a11y").hide();this._welAsideBar.addClass("off")},_exitSubMenu:function t(){this._welAsideBar.removeClass("off");return true},_onClickToggleCategory:function t(e){var n=$(e.currentTarget);if(n.hasClass("on")){this._closeTotalCtgLayer()}else{this._openTotalCtgLayer()}},_onMouseenterCategoryOpen:function t(){this._openTotalCtgLayer();this._bOpenSubArea=true},_onMouseleaveCategoryOpen:function t(){this._bOpenSubArea=false;this._checkSubCategoryArea()},_checkSubCategoryArea:function t(){var e=this;this._oTimeoutCate=setTimeout(function(){if(e._bOpenSubArea){clearTimeout(e._oTimeoutCate);e._oTimeoutCate=null;return}else{e._closeTotalCtgLayer()}},200)},_isOverHeight:function t(e){var n=e.offset();var i={top:this._window.scrollTop(),left:this._window.scrollLeft()};var s=40;i.bottom=i.top+this._window.height()-s;this._welCtgTotal.height(i.bottom-n.top)},_openTotalCtgLayer:function t(){this._welAsideBar.addClass("off");this._welCtgOpen.addClass("on").attr("aria-expanded","true").find(".blind").text("전체 카테고리 닫기");this._welCtgTotal.addClass("on").attr("aria-hidden","false");if(!this._nDefaultWidth){this._nDefaultWidth=this._welCtgList.width()}this._isOverHeight(this._welCtgTotal);this._welCtgArea.one("clickoutside.ctgAll",$.proxy(this._closeTotalCtgLayer,this));this._welCtgArea.on("keydown.a11y",$.proxy(this._onKeydownA11y,this));this._welCtgList.on("click.a11y",".emgnb_ctg_a11y",$.proxy(this._onClickA11yBtn,this));this._welCtgList.on("focusin.a11y",".emgnb_ctg_topmn, .emgnb_ctg_submn",$.proxy(this._onFocusinA11yList,this))},_closeTotalCtgLayer:function t(){this._welAsideBar.removeClass("off");this._welCtgOpen.removeClass("on").attr("aria-expanded","false").find(".blind").text("전체 카테고리 보기");this._welCtgTotal.removeClass("on").attr("aria-hidden","true");this._welCtgArea.off("clickoutside.ctgAll keydown.a11y");this._welCtgList.off("click.a11y focusin.a11y");this._welCtgList.find("li.on").removeClass("on").find(">.emgnb_ctg_a11y").removeClass("on").attr("aria-expanded","false").hide();this._welCtgCont.css("width",this._nDefaultWidth+"px")},_onClickA11yBtn:function t(e){var n=$(e.currentTarget);var i=n.parent();if(n.hasClass("on")){this._hideSubMenu(i)}else{this._showSubMenu(i)}},_onFocusinA11yList:function t(e){var n=$(e.currentTarget);if(this._bMouseOver){return}n.find(">.emgnb_ctg_a11y").show();n.siblings(":not(.on)").find(">.emgnb_ctg_a11y").hide();n.siblings().find("li:not(.on) .emgnb_ctg_a11y").hide()},_onKeydownA11y:function t(e){var n=e.sKeyCode||e.which;var i=n===9||n==="Tab";var s=n===27||n==="Escape";var a=null;var o=0;var r=null;if(s){a=this._welCtgList.find("li.on");o=a.length;if(o){r=$(a.get(o-1));this._hideSubMenu(r);r.find("li:not(.on) .emgnb_ctg_a11y").hide();r.find(">a").focus()}else{this._closeTotalCtgLayer()}}if(i){this._bMouseOver=false}},_showSubMenu:function t(e){var n=e.data("ctgLevel");this._oCurrent.elem=e;this._oCurrent.level=n;e.addClass("on").siblings().removeClass("on").find("li.on").removeClass("on");e.find(">.ctg_a11y_btn").addClass("on").attr("aria-expanded","true");e.siblings().find(".ctg_a11y_btn").removeClass("on").attr("aria-expanded","false").hide();this._updateSubMenu()},_hideSubMenu:function t(e){e.removeClass("on");e.find(".ctg_a11y_btn").removeClass("on").attr("aria-expanded","false");this._updateCtgLayerWidth()},_updateSubMenu:function t(){var e=this._oCurrent.elem;var n=this._oCurrent.level;var i=e.data("append")==="complete"?true:false;var s=null;if(i){this._updateCtgLayerWidth();return}if(n===1){this.emit("subCategoryMenu",e.data("ctgCode").toString());return}s=e.data("ctgData");if(typeof s!=="undefined"&&n<this._nMaxLevel){this._renderSubMenu(s,"mid")}else{this._updateCtgLayerWidth()}},_getTotalWidth:function t(){var n=0;this._welCtgList.find(".emgnb_ctg_subarea:visible").each(function(t){var e=$(this);n+=parseInt(e.outerWidth(),10)});return n},_updateCtgLayerWidth:function t(){this._welCtgCont.css("width",this._nDefaultWidth+this._getTotalWidth()+"px")},_chunkCtgData:function t(e,n){var i=0;var s=e.length;var a=[];for(i=0;i<s;i+=n){a.push(e.slice(i,i+n))}return a},_attachEventSubMenu:function t(e){e.find(".emgnb_ctg_sublist").menuAim({rowSelector:".emgnb_ctg_submn",activate:$.proxy(this._activeSubMenu,this),exitMenu:function t(){return true}}).find(".emgnb_ctg_submn").off("click")},_setNextChildMenu:function t(e,s){e.find(".emgnb_ctg_submn").each(function(t){var e=$(this);var n=s[t];var i=n.L.length;if(i){e.addClass("emlnb_sub_child").data("ctgData",n).append('<button role="menuitem" aria-haspopup="true" aria-expanded="false" class="emgnb_ctg_a11y" type="button"><span class="blind">'+n.N+" 하위메뉴"+i+"개의 항목</span></button>")}})},_setCategoryTmpl:function t(e,n){var i=this._oCurrent.elem;var s=this._oCurrent.level+1;var a=e.L;var o=a.length;var r=null;var l=e.BANR?"has_subtheme":"";if(!o){i.data("append","complete");return}if(!i.find(">.emgnb_ctg_subarea").length){i.append('<div class="emgnb_ctg_subarea emgnb_sub_lv'.concat(s," ").concat(l,'"></div>'))}r=$("#_tmplLnbCategory").tmpl({data:e,nLevel:s,sType:n});if(s<this._nMaxLevel){this._setNextChildMenu(r,a)}r.appendTo(i.find(">.emgnb_ctg_subarea"));i.data("append","complete").removeData("ctgData")},_filterCtgDataByType:function t(e,n){return $.grep(e,function(t,e){return t.CTG_TYPE===n})},_getCtgDataByNormalType:function t(e){return $.grep(e,function(t,e){return t.CTG_TYPE!=="20"&&t.CTG_TYPE!=="40"})},_renderCtgType:function t(e,n,i){var s=null;if(i==="top"){s=this._filterCtgDataByType(n,"20")}else if(i==="btm"){s=this._filterCtgDataByType(n,"40")}else{s=this._getCtgDataByNormalType(n)}if(s.length){e.L=s;this._renderSubMenu(e,i)}},_renderSubMenu:function t(e,n){var i=this._oCurrent.elem;this._setCategoryTmpl(e,n);this._updateCtgLayerWidth();this._attachEventSubMenu(i)},render:function t(e){if(e.hasOwnProperty("L")){var n=e.L;if(e.KILR_DISP_CTG_YN==="Y"){this._renderCtgType(e,n,"mid")}else{this._renderCtgType(e,n,"top");this._renderCtgType(e,n,"mid");this._renderCtgType(e,n,"btm")}}}},ssg.Event.emitter);$(function(){var t=function(){var t=$(".js_gnb_tooltip");var n=null;function i(t){t.addClass("on");t.find(".js_gnb_open").attr("aria-expanded","true");t.find(".js_gnb_layer").attr("aria-hidden","false")}function s(t){t.removeClass("on");t.find(".js_gnb_open").attr("aria-expanded","false");t.find(".js_gnb_layer").attr("aria-hidden","true")}function e(){t.on("click",".js_gnb_open",function(t){t.preventDefault();var e=$(t.currentTarget).closest(".js_gnb_tooltip");if(e.hasClass("on")){s(e)}else{i(e)}});t.on("mouseenter",function(t){var e=$(t.currentTarget);i(e)}).on("mouseleave",function(t){var e=$(t.currentTarget);s(e)});t.on("focusin",function(t){window.clearTimeout(n);n=null}).on("focusout",function(t){var e=$(t.currentTarget);if(e.find(".js_gnb_layer").is(":visible")){n=window.setTimeout(function(){s(e)},150)}})}return{init:e}}();t.init()});em.View.totalCategoryNew=function(t){$.extend(this,t||{});this.init()};em.View.totalCategoryNew.prototype=$.extend({_nDefaultWidth:0,_nMaxLevel:3,_bMouseOver:false,_oCurrent:{elem:null,level:0},init:function t(){this._assignElements();this._attachEventHandlers()},_assignElements:function t(){this._window=$(window);this._welCtgArea=$(".emgnb_ctg");this._welCtgTotal=this._welCtgArea.find(".emgnb_ctg_total");this._welCtgCont=this._welCtgTotal.find(".emgnb_ctg_cont");this._welCtgList=this._welCtgTotal.find(".emgnb_ctg_list");this._welCtgOpen=this._welCtgArea.find(".emgnb_ctg_open");this._welAsideBar=$("#_cmskyCard, #sky_scraper")},_attachEventHandlers:function t(){this._welCtgOpen.on("click",$.proxy(this._onClickToggleCategory,this));this._welCtgArea.on("mouseenter",$.proxy(this._onMouseenterCategoryOpen,this));this._welCtgArea.on("mouseleave",$.proxy(this._onMouseleaveCategoryOpen,this));this._welCtgList.menuAim({rowSelector:".emgnb_ctg_topmn",activate:$.proxy(this._activeSubMenu,this),enter:$.proxy(this._enterSubMenu,this),exitMenu:$.proxy(this._exitSubMenu,this)}).find(".emgnb_ctg_topmn").off("click");this._welCtgList.find(".emgnb_ctg_sublist").menuAim({rowSelector:".emgnb_ctg_submn",activate:$.proxy(this._activeSubMenu,this),exitMenu:function t(){return true}}).find(".emgnb_ctg_submn").off("click")},_activeSubMenu:function t(e){var n=$(e);this._showSubMenu(n)},_deactivateSubMenu:function t(e){var n=$(e);this._hideSubMenu(n)},_enterSubMenu:function t(){this._bMouseOver=true;this._welCtgList.find(".emgnb_ctg_a11y").hide();this._welAsideBar.addClass("off")},_exitSubMenu:function t(){this._welAsideBar.removeClass("off");return true},_onClickToggleCategory:function t(e){var n=$(e.currentTarget);if(n.hasClass("on")){this._closeTotalCtgLayer()}else{this._openTotalCtgLayer()}},_onMouseenterCategoryOpen:function t(){this._openTotalCtgLayer();this._bOpenSubArea=true},_onMouseleaveCategoryOpen:function t(){this._bOpenSubArea=false;this._checkSubCategoryArea()},_checkSubCategoryArea:function t(){var e=this;this._oTimeoutCate=setTimeout(function(){if(e._bOpenSubArea){clearTimeout(e._oTimeoutCate);e._oTimeoutCate=null;return}else{e._closeTotalCtgLayer()}},200)},_isOverHeight:function t(e){var n=e.offset();var i={top:this._window.scrollTop(),left:this._window.scrollLeft()};var s=40;i.bottom=i.top+this._window.height()-s;this._welCtgTotal.height(i.bottom-n.top)},_openTotalCtgLayer:function t(){this._welAsideBar.addClass("off");this._welCtgOpen.addClass("on").attr("aria-expanded","true").find(".blind").text("전체 카테고리 닫기");this._welCtgTotal.addClass("on").attr("aria-hidden","false");if(!this._nDefaultWidth){this._nDefaultWidth=this._welCtgList.width()}this._isOverHeight(this._welCtgTotal);this._welCtgArea.one("clickoutside.ctgAll",$.proxy(this._closeTotalCtgLayer,this));this._welCtgArea.on("keydown.a11y",$.proxy(this._onKeydownA11y,this));this._welCtgList.on("click.a11y",".emgnb_ctg_a11y",$.proxy(this._onClickA11yBtn,this));this._welCtgList.on("focusin.a11y",".emgnb_ctg_topmn, .emgnb_ctg_submn",$.proxy(this._onFocusinA11yList,this))},_closeTotalCtgLayer:function t(){this._welAsideBar.removeClass("off");this._welCtgOpen.removeClass("on").attr("aria-expanded","false").find(".blind").text("전체 카테고리 보기");this._welCtgTotal.removeClass("on").attr("aria-hidden","true");this._welCtgArea.off("clickoutside.ctgAll keydown.a11y");this._welCtgList.off("click.a11y focusin.a11y");this._welCtgList.find("li.on").removeClass("on").find(">.emgnb_ctg_a11y").removeClass("on").attr("aria-expanded","false").hide();this._welCtgCont.css("width",this._nDefaultWidth+"px")},_onClickA11yBtn:function t(e){var n=$(e.currentTarget);var i=n.parent();if(n.hasClass("on")){this._hideSubMenu(i)}else{this._showSubMenu(i)}},_onFocusinA11yList:function t(e){var n=$(e.currentTarget);if(this._bMouseOver){return}n.find(">.emgnb_ctg_a11y").show();n.siblings(":not(.on)").find(">.emgnb_ctg_a11y").hide();n.siblings().find("li:not(.on) .emgnb_ctg_a11y").hide()},_onKeydownA11y:function t(e){var n=e.sKeyCode||e.which;var i=n===9||n==="Tab";var s=n===27||n==="Escape";var a=null;var o=0;var r=null;if(s){a=this._welCtgList.find("li.on");o=a.length;if(o){r=$(a.get(o-1));this._hideSubMenu(r);r.find("li:not(.on) .emgnb_ctg_a11y").hide();r.find(">a").focus()}else{this._closeTotalCtgLayer()}}if(i){this._bMouseOver=false}},_showSubMenu:function t(e){var n=e.data("ctgLevel");this._oCurrent.elem=e;this._oCurrent.level=n;e.addClass("on").siblings().removeClass("on").find("li.on").removeClass("on");e.find(">.ctg_a11y_btn").addClass("on").attr("aria-expanded","true");e.siblings().find(".ctg_a11y_btn").removeClass("on").attr("aria-expanded","false").hide();this._updateSubMenu()},_hideSubMenu:function t(e){e.removeClass("on");e.find(".ctg_a11y_btn").removeClass("on").attr("aria-expanded","false");this._updateCtgLayerWidth()},_updateSubMenu:function t(){this._updateCtgLayerWidth()},_getTotalWidth:function t(){var n=0;this._welCtgList.find(".emgnb_ctg_subarea:visible").each(function(t){var e=$(this);n+=parseInt(e.outerWidth(),10)});return n},_updateCtgLayerWidth:function t(){this._welCtgCont.css("width",this._nDefaultWidth+this._welCtgList.find(".emgnb_ctg_subarea:visible").outerWidth()+"px")}},ssg.Event.emitter);
//# sourceMappingURL=em.view.gnb.js.map
